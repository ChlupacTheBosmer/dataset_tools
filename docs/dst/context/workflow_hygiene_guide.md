# Workflow Hygiene Guide

Recommended curation workflow for `dataset_tools`.

## Core Principles

1. Disk annotations are the source of truth.
2. FiftyOne is the exploration/state layer (tags, views, review state).
3. Label Studio is the correction layer for selected batches.
4. Sync back to disk is explicit and reviewable.

## Standard Flow

### 1) Load dataset into FiftyOne

```bash
./dst data load yolo --dataset <dataset_name> --root <dataset_root> --overwrite
```

### 2) Curate in FiftyOne

- Open app and review samples.
- Tag samples for operations (`fix`, `delete`, `duplicate`, etc.).

```bash
./dst app open --dataset <dataset_name>
```

### 3) Send tagged subset to Label Studio

```bash
./dst workflow roundtrip \
  --dataset <dataset_name> \
  --tag fix \
  --project <project_name> \
  --upload-strategy sdk_batched \
  --skip-pull \
  --skip-sync-disk
```

### 4) Annotate in Label Studio

- Update/submit annotations in the LS UI.

### 5) Pull submitted annotations back to FiftyOne

```bash
./dst workflow roundtrip \
  --dataset <dataset_name> \
  --tag fix \
  --project <project_name> \
  --skip-send \
  --skip-sync-disk
```

### 6) Sync reviewed corrections to disk

Dry run first:

```bash
./dst sync disk --dataset <dataset_name> --tag fix --dry-run
```

Then write:

```bash
./dst sync disk --dataset <dataset_name> --tag fix
```

## Notes

- Keep original labels and corrections in separate fields until sync.
- Use backup files generated by sync for rollback safety.
- Avoid unstructured LS target-storage exports as your primary source of truth.
